# 辅听音效

## 打开辅听配置
![](./assets/aid_0.png)</br>

* 可配置辅听mic采样率、是否和音乐播放互斥、是否和提示音播放互斥</br>
`注意：如果要和播歌和提示音工程，需要配送固定全局输出采样率`

## 辅听音效流程

辅听音效与媒体相同，根据DAC声道配置，也内置了多个预设模式，此处以`单mic输出到单声道dac`框图为例，浅析各模块的用处。
![](./assets/aid_1.png)</br>

- **ADC**：麦克风音效，需要一个输入源，可以配置为模拟输入（ADC）、数字输入（IIS_RX）
- **SRC**：音频同步模块。
- **NoiseGate**：噪声门限，滤除低于门限阈值的噪声。
- **音量控制器**：混响音量独立处理。
- **EQ**：前EQ，混响通路主要的音效EQ。
- **DRC**：动态范围压缩，可配置为限幅器、压缩器、扩展器。
- **Frequency Shift**：啸叫抑制（移频法），对输入信号的频率进行整体平移。
- **Howling Suppress**：啸叫抑制（陷波法），在某一个频率点迅速衰减输入信号。
- **LLNS**：低延时降噪。
- **BitWidth Convert**：位宽转换，更加后级输出自动转换需要的位宽。
- **Channel Merge**：声道合并，可实现4转双声道，双转单声道。
- **Channel Expander**：声道扩展，单转双声道，双转4声道。
- **声道拆分**：讲立体声数据拆分成左右两路数据。
- **声道合并**：将两路单声道数据合并成一路立体声数据。
- **DAC**：模拟输出方式，亦可配置为IIS数字输出方式。

</br>

    目前，预置了4个数据流款图，分别是：</br>
    DHA_1mic_2_mono_dac ： 单mic输出到单声道dac
    DHA_2mic_2_mono_dac ： 双mic输出到单声道dac
    DHA_1mic_2_stereo_dac ： 单mic输出到立体声dac
    DHA_2mic_2_stereo_dac : 双mic输出到立体声dac

## 辅听相关接口
```c
/*打开辅听*/
int hearing_aid_player_open();

/*关闭辅听*/
void hearing_aid_player_close();

/*辅听开/关切换*/
void  hearing_aid_switch();
```
更多接口参考mic_effect.h


- 程序中的麦克风通路默认使用按键开关，可自行配置情景配置按键功能，通过按键发送辅听开关的消息
- 亦可自行定义流程，调用接口开关麦克风通路



